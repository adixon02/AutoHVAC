<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HVAC Load Calculation Report - {{ project_label }}</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 40px;
            background: #fff;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #667eea;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #667eea;
            font-size: 32px;
            margin: 0 0 10px 0;
            font-weight: bold;
        }
        
        .header .subtitle {
            color: #666;
            font-size: 18px;
            margin: 0;
        }
        
        .project-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        
        .project-info h2 {
            color: #667eea;
            margin-top: 0;
            font-size: 24px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
        }
        
        .info-label {
            font-weight: bold;
            color: #555;
            font-size: 14px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .info-value {
            color: #333;
            font-size: 16px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #667eea;
            font-size: 24px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .load-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .load-summary h3 {
            margin: 0 0 20px 0;
            font-size: 20px;
        }
        
        .load-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .load-item {
            text-align: center;
        }
        
        .load-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .load-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .rooms-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .rooms-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .rooms-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .rooms-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .rooms-table tr:hover {
            background: #e3f2fd;
        }
        
        .recommendations {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .recommendations h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        
        .recommendation-item {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }
        
        .recommendation-item::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
        }
        
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
            text-align: center;
            color: #666;
            font-size: 14px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        @media print {
            body {
                padding: 20px;
            }
            
            .section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">AutoHVAC</div>
        <h1>HVAC Load Calculation Report</h1>
        <p class="subtitle">Professional Manual J Analysis</p>
    </div>

    <!-- Project Information -->
    <div class="project-info">
        <h2>{{ project_label }}</h2>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">Project Name</div>
                <div class="info-value">{{ project_label }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Analysis Date</div>
                <div class="info-value">{{ analysis_date }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Blueprint File</div>
                <div class="info-value">{{ filename }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Project ID</div>
                <div class="info-value">{{ project_id }}</div>
            </div>
        </div>
    </div>

    <!-- Load Summary -->
    <div class="load-summary">
        <h3>Total Load Summary</h3>
        <div class="load-grid">
            <div class="load-item">
                <div class="load-value">{{ total_heating_btu | number_format }}</div>
                <div class="load-label">BTU/hr Heating</div>
            </div>
            <div class="load-item">
                <div class="load-value">{{ total_cooling_btu | number_format }}</div>
                <div class="load-label">BTU/hr Cooling</div>
            </div>
        </div>
    </div>

    <!-- Room-by-Room Analysis -->
    <div class="section">
        <h2>Room-by-Room Analysis</h2>
        <table class="rooms-table">
            <thead>
                <tr>
                    <th>Room Name</th>
                    <th>Area (sq ft)</th>
                    <th>Heating Load (BTU/hr)</th>
                    <th>Cooling Load (BTU/hr)</th>
                    <th>Load Factor</th>
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr>
                    <td><strong>{{ room.name }}</strong></td>
                    <td>{{ room.area | default(0) }}</td>
                    <td>{{ room.heating_load | number_format }}</td>
                    <td>{{ room.cooling_load | number_format }}</td>
                    <td>{{ "%.1f" | format((room.heating_load / room.area) if room.area > 0 else 0) }} BTU/sq ft</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Equipment Recommendations -->
    <div class="section">
        <h2>Equipment Recommendations</h2>
        <div class="recommendations">
            <h3>Recommended HVAC System Specifications</h3>
            
            <div class="recommendation-item">
                <strong>Heating Capacity:</strong> {{ recommended_heating_tons }} tons 
                ({{ recommended_heating_btu | number_format }} BTU/hr)
            </div>
            
            <div class="recommendation-item">
                <strong>Cooling Capacity:</strong> {{ recommended_cooling_tons }} tons 
                ({{ recommended_cooling_btu | number_format }} BTU/hr)
            </div>
            
            <div class="recommendation-item">
                <strong>System Type:</strong> {{ recommended_system_type | default("Central Air with Gas Furnace") }}
            </div>
            
            <div class="recommendation-item">
                <strong>Duct Sizing:</strong> Design for {{ recommended_cfm }} CFM total airflow
            </div>
            
            {% if equipment_notes %}
            <div class="recommendation-item">
                <strong>Additional Notes:</strong> {{ equipment_notes }}
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Analysis Details -->
    <div class="section">
        <h2>Analysis Details</h2>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">Analysis Method</div>
                <div class="info-value">Manual J (8th Edition) via AI-Assisted Blueprint Analysis</div>
            </div>
            <div class="info-item">
                <div class="info-label">Climate Zone</div>
                <div class="info-value">{{ climate_zone | default("Based on project location") }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Total Rooms Analyzed</div>
                <div class="info-value">{{ rooms | length }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Total Building Area</div>
                <div class="info-value">{{ total_area }} sq ft</div>
            </div>
        </div>
    </div>

    <!-- Compliance Notice -->
    <div class="section">
        <h2>Compliance & Standards</h2>
        <p>This load calculation has been performed in accordance with ACCA Manual J (8th Edition) standards 
        for residential and light commercial HVAC system sizing. The analysis considers:</p>
        
        <ul style="margin-top: 15px; padding-left: 20px;">
            <li>Building envelope characteristics</li>
            <li>Window orientations and solar heat gain</li>
            <li>Insulation levels and thermal bridging</li>
            <li>Infiltration and ventilation requirements</li>
            <li>Internal heat gains from occupants and equipment</li>
            <li>Local climate conditions</li>
        </ul>
        
        <p style="margin-top: 20px; font-style: italic; color: #666;">
            <strong>Note:</strong> This automated analysis should be reviewed by a qualified HVAC professional 
            before final equipment selection and installation. Site-specific conditions may require adjustments 
            to these recommendations.
        </p>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="logo">AutoHVAC</div>
        <p>Generated on {{ generation_date }} | Professional HVAC Load Calculations</p>
        <p>For questions about this report, please contact your HVAC professional.</p>
    </div>
</body>
</html>